<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MULTIPLICA SAM - Sistema Avan√ßado de Monitoramento v3.0</title>
    
    <style>
        /* ========== VARI√ÅVEIS E RESET ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
        }

        :root {
            /* Tema Dark (Padr√£o) */
            --bg-primary: #0a0a0b;
            --bg-secondary: #141416;
            --bg-card: #1c1c1f;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --accent: #3b82f6;
            --accent-glow: rgba(59, 130, 246, 0.5);
            --accent-cyan: #06b6d4;
            --accent-purple: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: rgba(255, 255, 255, 0.1);
            --glass: rgba(20, 20, 22, 0.8);
            --nav-height: 80px;
            --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #f1f5f9;
            --bg-card: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --accent: #2563eb;
            --accent-glow: rgba(37, 99, 235, 0.2);
            --border: rgba(0, 0, 0, 0.08);
            --glass: rgba(248, 250, 252, 0.9);
        }

        body {
            font-family: 'Inter', -apple-system, system-ui, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            transition: background 0.5s ease;
        }

        /* ========== SCROLLBAR PERSONALIZADA ========== */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); }
        ::-webkit-scrollbar-thumb { 
            background: var(--bg-card); 
            border: 2px solid var(--bg-primary);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

        /* ========== NAVEGA√á√ÉO ========== */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            height: var(--nav-height);
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 5%;
            justify-content: space-between;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 800;
            font-size: 20px;
            letter-spacing: -0.5px;
            color: var(--text-primary);
            text-decoration: none;
        }

        .brand-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-cyan);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--accent-cyan);
            animation: pulse 2s infinite;
        }

        .nav-menu {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition-smooth);
            position: relative;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--text-primary);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: width 0.3s ease;
        }

        .nav-link:hover::after { width: 100%; }

        .theme-control {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            transition: var(--transition-smooth);
        }

        .theme-control:hover { border-color: var(--accent); color: var(--text-primary); }

        /* ========== HERO SECTION ========== */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            padding: 100px 5% 60px;
            position: relative;
            overflow: hidden;
            background: radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.05) 0%, transparent 50%);
        }

        .hero::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0; left: 0;
            background-image: radial-gradient(var(--border) 1px, transparent 1px);
            background-size: 40px 40px;
            mask-image: linear-gradient(to bottom, black, transparent);
            z-index: -1;
        }

        .hero-grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 60px;
            align-items: center;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .hero-content h1 {
            font-size: clamp(48px, 8vw, 92px);
            line-height: 0.95;
            font-weight: 900;
            letter-spacing: -4px;
            margin-bottom: 24px;
        }

        .text-gradient {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-subtitle {
            font-size: 20px;
            color: var(--text-secondary);
            max-width: 600px;
            margin-bottom: 40px;
            font-weight: 400;
        }

        .hero-actions {
            display: flex;
            gap: 16px;
        }

        .btn {
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: var(--transition-smooth);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            border: none;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
            box-shadow: 0 10px 20px var(--accent-glow);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px var(--accent-glow);
            filter: brightness(1.1);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover { background: var(--border); }

        .hero-stats-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 32px;
            position: relative;
            box-shadow: 0 40px 80px rgba(0,0,0,0.3);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 24px;
            align-items: center;
        }

        .status-tag {
            padding: 4px 12px;
            border-radius: 20px;
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .mini-chart {
            display: flex;
            align-items: flex-end;
            gap: 6px;
            height: 100px;
            margin-bottom: 24px;
        }

        .chart-bar {
            flex: 1;
            background: var(--accent);
            border-radius: 4px 4px 0 0;
            opacity: 0.6;
            transition: height 1.5s ease;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .stat-box {
            padding: 16px;
            border-radius: 16px;
            background: rgba(255,255,255,0.03);
        }

        .stat-val { font-size: 24px; font-weight: 800; display: block; }
        .stat-label { font-size: 11px; color: var(--text-secondary); text-transform: uppercase; }

        /* ========== EXPLORER SECTION (SEARCH) ========== */
        .section-padding { padding: 100px 5%; }
        
        .section-header {
            margin-bottom: 60px;
            max-width: 800px;
        }

        .section-title {
            font-size: 42px;
            font-weight: 800;
            letter-spacing: -1.5px;
            margin-bottom: 16px;
        }

        .search-wrapper {
            position: relative;
            margin-bottom: 40px;
        }

        .search-main {
            width: 100%;
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 24px 30px 24px 60px;
            border-radius: 16px;
            color: var(--text-primary);
            font-size: 18px;
            outline: none;
            transition: var(--transition-smooth);
        }

        .search-main:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px var(--accent-glow);
        }

        .search-icon-fixed {
            position: absolute;
            left: 24px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 20px;
        }

        .grid-localidades {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }

        .card-loc {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 24px;
            cursor: pointer;
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .card-loc:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .card-loc.active {
            border-color: var(--accent);
            background: linear-gradient(135deg, var(--bg-card), rgba(59, 130, 246, 0.05));
        }

        .card-img-wrapper {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: var(--bg-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .card-img { width: 100%; height: 100%; object-fit: cover; }

        .card-info h3 { font-size: 18px; margin-bottom: 4px; }
        .card-info p { font-size: 13px; color: var(--text-secondary); font-family: monospace; }

        /* ========== MAPA INTERATIVO ========== */
        .map-section {
            background: var(--bg-secondary);
            overflow: hidden;
            display: none; /* Ativado via JS */
        }

        .map-section.visible { display: block; animation: fadeIn 0.8s ease; }

        .map-container {
            height: 700px;
            background: #000;
            border-radius: 30px;
            position: relative;
            border: 1px solid var(--border);
            cursor: grab;
            overflow: hidden;
        }

        .map-controls {
            position: absolute;
            bottom: 30px;
            left: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 10;
        }

        .ctrl-btn {
            width: 44px;
            height: 44px;
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            backdrop-filter: blur(10px);
        }

        .ctrl-btn:hover { background: var(--accent); color: white; }

        #map-wrapper {
            width: 100%;
            height: 100%;
            transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        svg#hortolandia-svg {
            height: 80%;
            width: auto;
        }

        .road-path {
            fill: none;
            stroke: rgba(255,255,255,0.1);
            stroke-width: 1.5;
            transition: 0.3s;
        }

        .marker {
            position: absolute;
            width: 32px;
            height: 32px;
            background: var(--accent);
            border: 3px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .marker:hover { transform: translate(-50%, -50%) scale(1.5); z-index: 100; }
        .marker.active { 
            background: var(--danger); 
            scale: 1.8; 
            box-shadow: 0 0 30px var(--danger);
            animation: markerPulse 1.5s infinite;
        }

        @keyframes markerPulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        /* ========== DASHBOARD ANAL√çTICO ========== */
        .dashboard-section {
            background: var(--bg-primary);
            display: none;
        }

        .dash-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        .analytics-card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 40px;
            border: 1px solid var(--border);
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
        }

        .data-label { color: var(--text-secondary); font-size: 14px; }
        .data-value { font-weight: 700; font-size: 16px; }

        .progress-container {
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 1s ease;
        }

        /* ========== ANIMA√á√ïES ========== */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }

        /* ========== FOOTER ========== */
        footer {
            padding: 80px 5%;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .footer-logo { font-size: 24px; font-weight: 900; margin-bottom: 20px; display: block; }
        .footer-copy { color: var(--text-secondary); font-size: 14px; }

        /* RESPONSIVIDADE */
        @media (max-width: 1024px) {
            .hero-grid { grid-template-columns: 1fr; }
            .hero-content { text-align: center; }
            .hero-actions { justify-content: center; }
            .hero-stats-panel { max-width: 500px; margin: 0 auto; }
            .dash-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body data-theme="dark">

    <nav>
        <a href="#" class="nav-brand">
            <div class="brand-dot"></div>
            MULTIPLICA SAM
        </a>
        <div class="nav-menu">
            <a href="#hero" class="nav-link active">In√≠cio</a>
            <a href="#explorer" class="nav-link">Localidades</a>
            <a href="#map-section" class="nav-link">Monitoramento</a>
            <button class="theme-control" onclick="toggleTheme()">
                <span id="theme-icon">üåô</span>
                <span id="theme-text">MODO DARK</span>
            </button>
        </div>
    </nav>

    <section class="hero" id="hero">
        <div class="hero-grid">
            <div class="hero-content">
                <span class="status-tag" style="margin-bottom: 20px; display: inline-block;">Hortol√¢ndia / SP ‚Ä¢ Live 2026</span>
                <h1>Transformando a <span class="text-gradient">Educa√ß√£o</span> em Dados.</h1>
                <p class="hero-subtitle">
                    Acompanhe em tempo real a performance, frequ√™ncia e infraestrutura das 35 unidades escolares integradas ao ecossistema MULTIPLICA.
                </p>
                <div class="hero-actions">
                    <button class="btn btn-primary" onclick="scrollToSection('explorer')">Iniciar Explora√ß√£o</button>
                    <button class="btn btn-secondary" onclick="window.open('https://google.com')">Documenta√ß√£o</button>
                </div>
            </div>

            <div class="hero-stats-panel">
                <div class="panel-header">
                    <h3>Atividade do Sistema</h3>
                    <span class="status-tag">Online</span>
                </div>
                <div class="mini-chart" id="heroChart">
                    </div>
                <div class="stat-grid">
                    <div class="stat-box">
                        <span class="stat-label">Total Alunos</span>
                        <span class="stat-val" id="totalStudents">12.480</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">M√©dia Frequ√™ncia</span>
                        <span class="stat-val" id="avgAttendance">94.2%</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section-padding" id="explorer">
        <div class="section-header">
            <h2 class="section-title">Encontre uma Unidade</h2>
            <p style="color: var(--text-secondary)">Utilize filtros inteligentes para localizar rapidamente qualquer ponto de monitoramento no munic√≠pio.</p>
        </div>

        <div class="search-wrapper">
            <span class="search-icon-fixed">üîç</span>
            <input type="text" class="search-main" placeholder="Ex: Jardim Santana, BR-22, Vila Real..." oninput="filterLocations(this.value)">
        </div>

        <div class="grid-localidades" id="locGrid">
            </div>
    </section>

    <section class="map-section section-padding" id="map-section">
        <div class="section-header">
            <h2 class="section-title">Mapa de Calor Operacional</h2>
            <p style="color: var(--text-secondary)" id="map-subtitle">Selecione uma unidade no mapa para visualizar a telemetria espec√≠fica.</p>
        </div>

        <div class="map-container">
            <div class="map-controls">
                <button class="ctrl-btn" onclick="mapZoom(1.2)">+</button>
                <button class="ctrl-btn" onclick="mapZoom(0.8)">-</button>
                <button class="ctrl-btn" onclick="resetMap()">‚ü≤</button>
            </div>
            
            <div id="map-wrapper">
                <div id="svg-host"></div>
                <div id="markers-overlay"></div>
            </div>
        </div>
    </section>

    <section class="dashboard-section section-padding" id="dashboard">
        <div class="section-header">
            <h2 class="section-title" id="dash-title">An√°lise de Unidade</h2>
            <p id="dash-subtitle">Consolidado de dados da unidade selecionada.</p>
        </div>

        <div class="dash-grid">
            <div class="analytics-card">
                <h3>M√©tricas de Desempenho</h3>
                <div id="unit-metrics">
                    </div>
            </div>

            <div class="analytics-card" style="display: flex; flex-direction: column; gap: 20px;">
                <h3>Infraestrutura</h3>
                <div class="stat-box">
                    <span class="stat-label">Capacidade Salas</span>
                    <span class="stat-val">32 / 32</span>
                    <div class="progress-container"><div class="progress-fill" style="width: 100%"></div></div>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Conectividade 5G</span>
                    <span class="stat-val" style="color: var(--success)">Excelente</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Consumo Energia</span>
                    <span class="stat-val">4.2 kW/h</span>
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: auto;" onclick="alert('Gerando Relat√≥rio PDF...')">Baixar Relat√≥rio Completo</button>
            </div>
        </div>
    </section>

    <footer>
        <span class="footer-logo">MULTIPLICA SAM</span>
        <p class="footer-copy">&copy; 2026 Hortol√¢ndia, SP. Sistema de Intelig√™ncia Governamental.</p>
    </footer>

    <script>
        // 1. DATASET COMPLETO (35 LOCALIDADES)
        const localidades = [
            { id: 0, nome: "Jardim Santana - Central", codigo: "BR-22-1431", x: 600, y: 245, img: "jardim-santana", alunos: 450, freq: 92 },
            { id: 1, nome: "Jardim Santa Izabel", codigo: "BR-22-1434", x: 809, y: 389, img: "jardim-santa-izabel", alunos: 320, freq: 88 },
            { id: 2, nome: "Jardim S√£o Pedro", codigo: "BR-22-1585", x: 605, y: 427, img: "jardim-sao-pedro", alunos: 290, freq: 95 },
            { id: 3, nome: "Jardim Mirante", codigo: "BR-22-1632", x: 644, y: 306, img: "jardim-mirante", alunos: 510, freq: 91 },
            { id: 4, nome: "Jardim Novo √Çngulo", codigo: "BR-22-1633", x: 805, y: 276, img: "jardim-novo-angulo", alunos: 380, freq: 89 },
            { id: 5, nome: "Vila Real", codigo: "BR-22-1997", x: 567, y: 129, img: "vila-real", alunos: 420, freq: 94 },
            { id: 6, nome: "Jardim Amanda I", codigo: "BR-22-2052", x: 480, y: 365, img: "amanda-1", alunos: 680, freq: 85 },
            { id: 7, nome: "Jardim Santa Esmeralda", codigo: "BR-22-2133", x: 680, y: 441, img: "jardim-santa-esmeralda", alunos: 310, freq: 96 },
            { id: 8, nome: "Jardim Santa Luzia", codigo: "BR-22-2141", x: 676, y: 213, img: "jardim-santa-luzia", alunos: 275, freq: 93 },
            { id: 9, nome: "Parque do Horto", codigo: "BR-22-2157", x: 610, y: 93, img: "parque-do-horto", alunos: 340, freq: 92 },
            { id: 10, nome: "Jardim Santa Clara", codigo: "BR-22-2227", x: 679, y: 341, alunos: 390, freq: 90 },
            { id: 11, nome: "Jardim Amanda II", codigo: "BR-22-2272", x: 450, y: 437, alunos: 720, freq: 86 },
            { id: 12, nome: "Jardim Adelaide", codigo: "BR-22-2273", x: 778, y: 464, alunos: 295, freq: 94 },
            { id: 13, nome: "Parque Orestes √îngaro", codigo: "BR-22-2381", x: 546, y: 59, alunos: 415, freq: 91 },
            { id: 14, nome: "Jardim S√£o Jorge", codigo: "BR-22-2591", x: 647, y: 177, alunos: 330, freq: 95 },
            { id: 15, nome: "Jardim S√£o Sebasti√£o", codigo: "BR-22-2592", x: 576, y: 370, alunos: 360, freq: 93 },
            { id: 16, nome: "Jardim do Bosque", codigo: "BR-22-2716", x: 681, y: 288, alunos: 280, freq: 97 },
            { id: 17, nome: "Vila Inema", codigo: "BR-22-2717", x: 771, y: 326, alunos: 440, freq: 92 },
            { id: 18, nome: "Jardim Aline", codigo: "BR-22-2795", x: 877, y: 180, alunos: 310, freq: 88 },
            { id: 19, nome: "Jardim Amanda III", codigo: "BR-22-3005", x: 411, y: 372, alunos: 650, freq: 87 },
            { id: 20, nome: "Ch√°caras Recreio", codigo: "BR-22-3057", x: 349, y: 384, alunos: 220, freq: 98 },
            { id: 21, nome: "Jardim Nova Europa", codigo: "BR-22-3178", x: 777, y: 181, alunos: 490, freq: 94 },
            { id: 22, nome: "Jardim das Colinas", codigo: "BR-22-3238", x: 517, y: 136, alunos: 350, freq: 93 },
            { id: 23, nome: "Residencial Jo√£o Luiz", codigo: "BR-22-3342", x: 679, y: 391, alunos: 405, freq: 90 },
            { id: 24, nome: "Jardim Auxiliadora", codigo: "BR-22-3400", x: 629, y: 121, alunos: 290, freq: 96 },
            { id: 25, nome: "Jardim Novo Horizonte", codigo: "BR-22-3493", x: 342, y: 279, alunos: 510, freq: 89 },
            { id: 26, nome: "Jardim Nova Am√©rica", codigo: "BR-22-3654", x: 833, y: 317, alunos: 420, freq: 91 },
            { id: 27, nome: "Jardim Interlagos", codigo: "BR-22-3833", x: 606, y: 350, alunos: 380, freq: 94 },
            { id: 28, nome: "Terras de Santo Ant√¥nio", codigo: "BR-22-3939", x: 735, y: 402, alunos: 315, freq: 95 },
            { id: 29, nome: "Residencial Firenze", codigo: "BR-22-4039", x: 456, y: 248, alunos: 460, freq: 93 },
            { id: 30, nome: "Nova Hortol√¢ndia", codigo: "BR-22-5421", x: 615, y: 144, alunos: 580, freq: 92 },
            { id: 31, nome: "Jardim Novo Cambu√≠", codigo: "BR-22-5550", x: 558, y: 297, alunos: 340, freq: 90 },
            { id: 32, nome: "Terras de Santa Maria", codigo: "BR-22-5607", x: 510, y: 116, alunos: 290, freq: 96 },
            { id: 33, nome: "Jardim Amanda IV", codigo: "BR-22-5419", x: 447, y: 332, alunos: 610, freq: 88 },
            { id: 34, nome: "Recanto do Sol", codigo: "BR-22-5266", x: 651, y: 142, alunos: 425, freq: 94 }
        ];

        // 2. ESTADO DA APLICA√á√ÉO
        let currentScale = 1;
        let isDark = true;
        let selectedId = null;

        // 3. INICIALIZA√á√ÉO
        window.addEventListener('DOMContentLoaded', () => {
            renderCards(localidades);
            initHeroChart();
            initMapMarkers();
        });

        // 4. SISTEMA DE TEMA
        function toggleTheme() {
            isDark = !isDark;
            document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
            document.getElementById('theme-icon').innerText = isDark ? 'üåô' : '‚òÄÔ∏è';
            document.getElementById('theme-text').innerText = isDark ? 'MODO DARK' : 'MODO LIGHT';
        }

        // 5. RENDERIZA√á√ÉO DE CARDS
        function renderCards(data) {
            const grid = document.getElementById('locGrid');
            grid.innerHTML = data.map(loc => `
                <div class="card-loc" onclick="selectLocation(${loc.id})">
                    <div class="card-img-wrapper">
                        <img src="assets/fotos/${loc.img || 'default'}.png" class="card-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/167/167707.png'">
                    </div>
                    <div class="card-info">
                        <h3>${loc.nome}</h3>
                        <p>${loc.codigo}</p>
                    </div>
                </div>
            `).join('');
        }

        // 6. BUSCA E FILTRO
        function filterLocations(query) {
            const filtered = localidades.filter(l => 
                l.nome.toLowerCase().includes(query.toLowerCase()) || 
                l.codigo.toLowerCase().includes(query.toLowerCase())
            );
            renderCards(filtered);
        }

        // 7. SELE√á√ÉO DE LOCALIDADE (CORE LOGIC)
        function selectLocation(id) {
            selectedId = id;
            const loc = localidades.find(l => l.id === id);
            
            // Ativa Se√ß√£o de Mapa
            document.getElementById('map-section').classList.add('visible');
            
            // Scroll para o mapa
            document.getElementById('map-section').scrollIntoView({ behavior: 'smooth' });

            // Atualiza Dashboard
            updateDashboard(loc);

            // Zoom no Mapa
            focusOnMap(loc);
        }

        // 8. DASHBOARD ANAL√çTICO
        function updateDashboard(loc) {
            const dash = document.getElementById('dashboard');
            dash.style.display = 'block';
            
            document.getElementById('dash-title').innerText = loc.nome;
            document.getElementById('dash-subtitle').innerText = `ID do Sistema: ${loc.codigo}`;

            const metrics = document.getElementById('unit-metrics');
            const metricsData = [
                { label: "Matriculados", value: loc.alunos, progress: 85 },
                { label: "Frequ√™ncia Real", value: `${loc.freq}%`, progress: loc.freq },
                { label: "Taxa de Reten√ß√£o", value: "98.5%", progress: 98 },
                { label: "Engajamento Plataforma", value: "76%", progress: 76 }
            ];

            metrics.innerHTML = metricsData.map(m => `
                <div class="data-row">
                    <span class="data-label">${m.label}</span>
                    <span class="data-value">${m.value}</span>
                </div>
                <div class="progress-container"><div class="progress-fill" style="width: ${m.progress}%"></div></div>
            `).join('');
        }

        // 9. MAPA INTERATIVO (SVG & MARKERS)
        function initMapMarkers() {
            const overlay = document.getElementById('markers-overlay');
            const svgHost = document.getElementById('svg-host');

            // Carrega SVG Dummy (Simulando o hortolandia-roads.svg)
            svgHost.innerHTML = `
                <svg id="hortolandia-svg" viewBox="0 0 1200 600">
                    <path class="road-path" d="M100,100 Q400,50 600,300 T1100,500" />
                    <path class="road-path" d="M200,500 L1000,100" />
                    <path class="road-path" d="M50,300 C200,100 800,500 1150,300" />
                </svg>
            `;

            localidades.forEach(loc => {
                const marker = document.createElement('div');
                marker.className = 'marker';
                marker.id = `marker-${loc.id}`;
                marker.style.left = `${loc.x}px`;
                marker.style.top = `${loc.y}px`;
                marker.onclick = (e) => {
                    e.stopPropagation();
                    selectLocation(loc.id);
                };
                overlay.appendChild(marker);
            });
        }

        function focusOnMap(loc) {
            const wrapper = document.getElementById('map-wrapper');
            const viewer = document.querySelector('.map-container');
            
            // Remove active markers
            document.querySelectorAll('.marker').forEach(m => m.classList.remove('active'));
            document.getElementById(`marker-${loc.id}`).classList.add('active');

            const vW = viewer.offsetWidth;
            const vH = viewer.offsetHeight;

            currentScale = 2.5;
            const tx = (vW / 2) - (loc.x * currentScale);
            const ty = (vH / 2) - (loc.y * currentScale);

            wrapper.style.transform = `translate(${tx}px, ${ty}px) scale(${currentScale})`;
        }

        function mapZoom(f) {
            currentScale *= f;
            currentScale = Math.min(Math.max(0.5, currentScale), 8);
            document.getElementById('map-wrapper').style.transform = `scale(${currentScale})`;
        }

        function resetMap() {
            currentScale = 1;
            document.getElementById('map-wrapper').style.transform = `translate(0,0) scale(1)`;
        }

        // 10. CHART SIMULATION (HERO)
        function initHeroChart() {
            const chart = document.getElementById('heroChart');
            for(let i=0; i<20; i++) {
                const h = Math.floor(Math.random() * 80) + 20;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${h}%`;
                chart.appendChild(bar);
            }

            // Anima√ß√£o cont√≠nua
            setInterval(() => {
                document.querySelectorAll('.chart-bar').forEach(bar => {
                    const h = Math.floor(Math.random() * 80) + 20;
                    bar.style.height = `${h}%`;
                });
            }, 3000);
        }

        // 11. UTILIT√ÅRIOS
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // 12. DRAG MAP (MOUSE)
        let isDragging = false;
        let startX, startY, scrollLeft, scrollTop;
        const container = document.querySelector('.map-container');

        container.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.pageX;
            startY = e.pageY;
            container.style.cursor = 'grabbing';
        });

        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const dx = e.pageX - startX;
            const dy = e.pageY - startY;
            // L√≥gica de Pan pode ser adicionada aqui
        });

        window.addEventListener('mouseup', () => {
            isDragging = false;
            container.style.cursor = 'grab';
        });

    </script>

    </body>
</html>
